<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>jmespath.cpp: jmespath.cpp</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">jmespath.cpp
   </div>
   <div id="projectbrief">C++ implementation of JMESPath, a query language for JSON http://jmespath.org</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">jmespath.cpp </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>jmespath.cpp is a C++ implementation of <a href="http://jmespath.org">JMESPath</a>, a query language for JSON. It can be used to extract and transform elements of a JSON document.</p>
<h1><a class="anchor" id="example"></a>
JMESPath expression example</h1>
<p>Input JSON document: </p>
<div class="fragment"><div class="line">{</div>
<div class="line">  <span class="stringliteral">&quot;locations&quot;</span>: [</div>
<div class="line">    {<span class="stringliteral">&quot;name&quot;</span>: <span class="stringliteral">&quot;Seattle&quot;</span>, <span class="stringliteral">&quot;state&quot;</span>: <span class="stringliteral">&quot;WA&quot;</span>},</div>
<div class="line">    {<span class="stringliteral">&quot;name&quot;</span>: <span class="stringliteral">&quot;New York&quot;</span>, <span class="stringliteral">&quot;state&quot;</span>: <span class="stringliteral">&quot;NY&quot;</span>},</div>
<div class="line">    {<span class="stringliteral">&quot;name&quot;</span>: <span class="stringliteral">&quot;Bellevue&quot;</span>, <span class="stringliteral">&quot;state&quot;</span>: <span class="stringliteral">&quot;WA&quot;</span>},</div>
<div class="line">    {<span class="stringliteral">&quot;name&quot;</span>: <span class="stringliteral">&quot;Olympia&quot;</span>, <span class="stringliteral">&quot;state&quot;</span>: <span class="stringliteral">&quot;WA&quot;</span>}</div>
<div class="line">  ]</div>
<div class="line">}</div>
</div><!-- fragment --><p>JMESPath expression: </p>
<div class="fragment"><div class="line">locations[?state == <span class="stringliteral">&#39;WA&#39;</span>].name | sort(@) | {WashingtonCities: join(<span class="stringliteral">&#39;, &#39;</span>, @)}</div>
</div><!-- fragment --><p>Result of evaluating the expression: </p>
<div class="fragment"><div class="line">{<span class="stringliteral">&quot;WashingtonCities&quot;</span>: <span class="stringliteral">&quot;Bellevue, Olympia, Seattle&quot;</span>}</div>
</div><!-- fragment --><p>For more examples take a look at the <a href="http://jmespath.org/tutorial.html">JMESPath Tutorial</a> or the <a href="http://jmespath.org/examples.html">JMESPath Examples</a> pages.</p>
<h1><a class="anchor" id="usage"></a>
Using jmespath.cpp</h1>
<p>For installation instructions check out the <a class="el" href="install.html">Installation and integration</a> page.</p>
<p>To use the public functions and classes of jmespath.cpp you should include the header file <code>"#include \&lt;jmespath/jmespath.h\&gt;"</code>. The public interface is declared in the <code>"jmespath"</code> namespace. </p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="jmespath_8h.html">jmespath/jmespath.h</a>&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="keyword">namespace </span>jp = jmespath;</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[])</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">auto</span> data = R<span class="stringliteral">&quot;({</span></div>
<div class="line"><span class="stringliteral">        &quot;locations&quot;: [</span></div>
<div class="line"><span class="stringliteral">            {&quot;name&quot;: &quot;Seattle&quot;, &quot;state&quot;: &quot;WA&quot;},</span></div>
<div class="line"><span class="stringliteral">            {&quot;name&quot;: &quot;New York&quot;, &quot;state&quot;: &quot;NY&quot;},</span></div>
<div class="line"><span class="stringliteral">            {&quot;name&quot;: &quot;Bellevue&quot;, &quot;state&quot;: &quot;WA&quot;},</span></div>
<div class="line"><span class="stringliteral">            {&quot;name&quot;: &quot;Olympia&quot;, &quot;state&quot;: &quot;WA&quot;}</span></div>
<div class="line"><span class="stringliteral">        ]</span></div>
<div class="line"><span class="stringliteral">    })&quot;_json;</span></div>
<div class="line"><span class="stringliteral">    jp::Expression expression = </span><span class="stringliteral">&quot;locations[?state == &#39;WA&#39;].name | sort(@) | &quot;</span></div>
<div class="line">                                <span class="stringliteral">&quot;{WashingtonCities: join(&#39;, &#39;, @)}&quot;</span>;</div>
<div class="line">    std::cout &lt;&lt; <a class="code" href="group__public.html#ga6df94674a4b7617fbd14a0c59f123dc6">jp::search</a>(expression, data) &lt;&lt; std::endl;</div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="search"></a>
Search function</h2>
<p>The main entry point of the library is the <a class="el" href="group__public.html#ga6df94674a4b7617fbd14a0c59f123dc6">jmespath::search</a> function which takes a JMESPath expression as its first argument and a JSON document as the second argument and returns the result of the evaluated expression as a new JSON document. </p>
<div class="fragment"><div class="line"><span class="keyword">auto</span> input = R<span class="stringliteral">&quot;({&quot;foo&quot;: &quot;bar&quot;})&quot;_json;</span></div>
<div class="line"><span class="stringliteral"></span><span class="keyword">auto</span> result = <a class="code" href="group__public.html#ga6df94674a4b7617fbd14a0c59f123dc6">jmespath::search</a>(<span class="stringliteral">&quot;foo&quot;</span>, input);</div>
</div><!-- fragment --><p>Besided passing the input document as an lvalue reference you can also pass it as an rvalue reference, which would allow the library to take advantage of move operations internally and produce the output document in a more efficient and faster manner. </p>
<div class="fragment"><div class="line"><span class="keyword">auto</span> input = R<span class="stringliteral">&quot;({&quot;foo&quot;: &quot;bar&quot;})&quot;_json;</span></div>
<div class="line"><span class="stringliteral"></span><span class="keyword">auto</span> result = <a class="code" href="group__public.html#ga6df94674a4b7617fbd14a0c59f123dc6">jmespath::search</a>(<span class="stringliteral">&quot;foo&quot;</span>, std::move(input));</div>
</div><!-- fragment --><h2><a class="anchor" id="expression"></a>
Expression class</h2>
<p>The <a class="el" href="group__public.html#classjmespath_1_1_expression">jmespath::Expression</a> class allows to store a parsed JMESPath expression which is usefull if you want to evaluate the same expression on multiple JSON documents. </p>
<div class="fragment"><div class="line"><a class="code" href="group__public.html#classjmespath_1_1_expression">jmespath::Expression</a> expression {<span class="stringliteral">&quot;foo&quot;</span>};</div>
<div class="line"><span class="keyword">auto</span> result1 = <a class="code" href="group__public.html#ga6df94674a4b7617fbd14a0c59f123dc6">jmespath::search</a>(expression, R<span class="stringliteral">&quot;({&quot;foo&quot;: &quot;bar&quot;})&quot;_json);</span></div>
<div class="line"><span class="stringliteral"></span><span class="keyword">auto</span> result2 = <a class="code" href="group__public.html#ga6df94674a4b7617fbd14a0c59f123dc6">jmespath::search</a>(expression, R<span class="stringliteral">&quot;({&quot;foo&quot;: {&quot;bar&quot;: &quot;baz&quot;}})&quot;_json);</span></div>
</div><!-- fragment --><p>By importing the names from the <a class="el" href="namespacejmespath_1_1literals.html">jmespath::literals</a> namespace you can also use user defined literals to define JMESPath expressions. </p>
<div class="fragment"><div class="line"><span class="keyword">using namespace </span>jmespath::literals;</div>
<div class="line"></div>
<div class="line"><span class="keyword">auto</span> expression = <span class="stringliteral">&quot;foo&quot;</span>_jmespath;</div>
<div class="line"><span class="keyword">auto</span> result1 = <a class="code" href="group__public.html#ga6df94674a4b7617fbd14a0c59f123dc6">jmespath::search</a>(expression, R<span class="stringliteral">&quot;({&quot;foo&quot;: &quot;bar&quot;})&quot;_json);</span></div>
<div class="line"><span class="stringliteral"></span><span class="keyword">auto</span> result2 = <a class="code" href="group__public.html#ga6df94674a4b7617fbd14a0c59f123dc6">jmespath::search</a>(expression, R<span class="stringliteral">&quot;({&quot;foo&quot;: {&quot;bar&quot;: &quot;baz&quot;}})&quot;_json);</span></div>
</div><!-- fragment --><h2><a class="anchor" id="json"></a>
JSON documents</h2>
<p>For the handling of JSON documents and values jmespath.cpp relies on the excelent <a href="https://github.com/nlohmann/json">nlohmann_json</a> library.</p>
<p>For defining JSON values you can either use <code>"_json"</code> user defined literal or the <a class="el" href="namespacejmespath.html#a6fbd10116b7258d0ca24137ff82ce9fe">jmespath::Json</a> type which is just an alias for <a href="https://github.com/nlohmann/json">nlohmann_json</a> </p>
<div class="fragment"><div class="line"><a class="code" href="namespacejmespath.html#a6fbd10116b7258d0ca24137ff82ce9fe">jmespath::Json</a> jsonObject {{<span class="stringliteral">&quot;foo&quot;</span>, <span class="stringliteral">&quot;bar&quot;</span>}};</div>
</div><!-- fragment --><p>or you can also include the header of the <a href="https://github.com/nlohmann/json">nlohmann_json</a> library and use the <code>"nlohmann::json"</code> type directly. </p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;nlohmann/json.hpp&gt;</span></div>
<div class="line"></div>
<div class="line">nlohmann::json jsonObject {{<span class="stringliteral">&quot;foo&quot;</span>, <span class="stringliteral">&quot;bar&quot;</span>}};</div>
</div><!-- fragment --><h2><a class="anchor" id="error"></a>
Error handling</h2>
<p>All the exceptions that might get thrown by <a class="el" href="group__public.html#ga6df94674a4b7617fbd14a0c59f123dc6">jmespath::search</a> or <a class="el" href="group__public.html#classjmespath_1_1_expression">jmespath::Expression</a> are listed on the <a class="el" href="group__exceptions.html">Exception classes</a> page.</p>
<p>The library uses the <a href="https://www.boost.org/doc/libs/1_69_0/libs/exception/doc/
boost-exception.html">Boost Exception</a> library for throwing exceptions. Which means that the thrown exceptions can <a href="https://www.boost.org/doc/libs/1_69_0/libs/exception/doc/
tutorial_transporting_data.html">carry additional data attached</a> to them. All the additional data that exceptions might carry is listed on the <a class="el" href="group__error__info.html">Error info types</a> page.</p>
<p>This additional information can be used for example to pinpoint exactly which part of a JMESPath expression caused a parsing failure. </p>
<div class="fragment"><div class="line"><a class="code" href="group__public.html#classjmespath_1_1_expression">jmespath::Expression</a> expression;</div>
<div class="line"></div>
<div class="line"><span class="keywordflow">try</span></div>
<div class="line">{</div>
<div class="line">     expression = <span class="stringliteral">&quot;foo?&quot;</span>;</div>
<div class="line">}</div>
<div class="line"><span class="keywordflow">catch</span> (<a class="code" href="group__exceptions.html#structjmespath_1_1_syntax_error">jmespath::SyntaxError</a>&amp; error)</div>
<div class="line">{</div>
<div class="line">     <span class="keywordflow">if</span> (<span class="keyword">const</span> std::string* searchExpression</div>
<div class="line">             = boost::get_error_info&lt;jmespath::InfoSearchExpression&gt;(error))</div>
<div class="line">     {</div>
<div class="line">         std::cerr &lt;&lt; <span class="stringliteral">&quot;Failed parsing expression: &quot;</span></div>
<div class="line">                   &lt;&lt; *searchExpression &lt;&lt; std::endl;</div>
<div class="line">     }</div>
<div class="line">     <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keywordtype">long</span>* location</div>
<div class="line">             = boost::get_error_info&lt;jmespath::InfoSyntaxErrorLocation&gt;(</div>
<div class="line">                 error))</div>
<div class="line">     {</div>
<div class="line">         std::cerr &lt;&lt; <span class="stringliteral">&quot;Error at position: &quot;</span> &lt;&lt; *location &lt;&lt; std::endl;</div>
<div class="line">     }</div>
<div class="line">}</div>
</div><!-- fragment --><p> This code would produce the following output: </p>
<div class="fragment"><div class="line">Failed parsing expression: foo?</div>
<div class="line">Error at position: 3</div>
</div><!-- fragment --><p>You can also use <a href="https://www.boost.org/doc/libs/1_69_0/libs/
exception/doc/tutorial_diagnostic_information.html">boost::diagnostic_information</a> function to get all the additional information attached to an exception. </p>
<div class="fragment"><div class="line"><a class="code" href="group__public.html#classjmespath_1_1_expression">jmespath::Expression</a> expression;</div>
<div class="line"></div>
<div class="line"><span class="keywordflow">try</span></div>
<div class="line">{</div>
<div class="line">     expression = <span class="stringliteral">&quot;foo?&quot;</span>;</div>
<div class="line">}</div>
<div class="line"><span class="keywordflow">catch</span> (<a class="code" href="group__exceptions.html#structjmespath_1_1_syntax_error">jmespath::SyntaxError</a>&amp; error)</div>
<div class="line">{</div>
<div class="line">     std::cerr &lt;&lt; boost::diagnostic_information(error) &lt;&lt; std::endl;</div>
<div class="line">}</div>
</div><!-- fragment --><p> This code would produce the following output: </p>
<div class="fragment"><div class="line">jmespath.cpp/src/parser/parser.h(90): Throw in <span class="keyword">function</span> <a class="code" href="classjmespath_1_1parser_1_1_parser.html#a2b30cf7e3f1471212d87cdd40197394e">jmespath::parser::Parser::ResultType</a> <a class="code" href="classjmespath_1_1parser_1_1_parser.html#a8767a75d1aeac92d21be16d8c0a87a5c">jmespath::parser::Parser&lt;parser::Grammar&gt;::parse</a>(<span class="keyword">const</span> <a class="code" href="namespacejmespath.html#ab178b37f05f638534caa4d585b767dfa">jmespath::String</a> &amp;) [T = parser::Grammar]</div>
<div class="line">Dynamic exception type: boost::exception_detail::clone_impl&lt;jmespath::SyntaxError&gt;</div>
<div class="line">std::exception::what: std::exception</div>
<div class="line">[jmespath::tag_search_expression*] = foo?</div>
<div class="line">[jmespath::tag_syntax_error_location*] = 3</div>
</div><!-- fragment --> </div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
